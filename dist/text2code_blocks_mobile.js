!function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t,n){"use strict";function s(e,t,n){const s=e&&e.getInput(t),r=n&&n.outputConnection;s&&r&&s.connection.connect(r)}function r(e){Blockly.Xml.clearWorkspaceAndLoadFromXml(Blockly.Xml.workspaceToDom(e),e),Blockly.svgResize(e)}function o(e,t){e.nextConnection&&t.previousConnection&&e.nextConnection.connect(t.previousConnection)}function i(e,t){const n=e.newBlock(t);return n.initSvg(),n.moveTo(new Blockly.utils.Coordinate(e.getMetrics().viewLeft,e.getMetrics().viewTop)),n}function a(e,t){e&&t&&t.moveBy(e.getRelativeToSurfaceXY().x-t.getRelativeToSurfaceXY().x,e.getRelativeToSurfaceXY().y-t.getRelativeToSurfaceXY().y)}function l(e){const t=e.getMetrics();return e.getAllBlocks().filter(e=>{const n=e.getBoundingRectangle();return n.left<t.viewLeft||n.right>t.viewLeft+t.viewWidth||n.top<t.viewTop||n.bottom>t.viewTop+t.viewHeight})}function c(e){const t=T2C.MSG.currentLanguage===T2C.MSG.PY?"Python":"JavaScript";l(e).filter(e=>e.getParent()&&!e.nextConnection&&!e.isCollapsed()).slice().forEach(n=>{if(n.isDisposed())return;const s=i(e,"code_expression");_(s,Blockly[t].blockToCode(n)[0]||Blockly[t].blockToCode(n),"EXP"),s.setCollapsed(!0),n.getParent().getInputWithBlock(n).connection.connect(s.outputConnection),n.dispose(!0)}),r(e),l(e).length>0&&e.zoomToFit()}function _(e,t,n){if(!n)return void console.warn("Ignoring request to set field value to",t," of ",e,"because no field name was given");const s=e.workspace;let r=t;e.type.toLowerCase().startsWith("variables_")&&"VAR"===n&&(r=-1===s.getAllVariableNames().indexOf(t)?s.createVariable(t).getId():s.getVariable(t).getId()),e.setFieldValue(r,n)}function u(e){if(!e)return null;let t=e.getParent();for(;t&&!t.previousConnection;)t=t.getParent();return t}function p(e){let t=e;for(;!t.nextConnection&&t.getParent();)t=t.getParent();for(;t.getNextBlock();)t=t.getNextBlock();return t}function g(e,t,n){const s=e.getParent();let r=null,o=null,i=-1,a=null;return e.inputList.forEach((function(e){e.fieldRow.forEach((function(e){t.getField(e.name)&&_(t,e.getValue(),e.name)}))})),s?(r=s.getInputWithBlock(e),o=r?r.connection:s.nextConnection,i=o.targetConnection.type,i===Blockly.OUTPUT_VALUE?o.connect(t.outputConnection):i===Blockly.PREVIOUS_STATEMENT&&(a=t.previousConnection)):t.moveBy(e.getRelativeToSurfaceXY().x-t.getRelativeToSurfaceXY().x,e.getRelativeToSurfaceXY().y-t.getRelativeToSurfaceXY().y),e.getChildren().slice().forEach((function(n){if(e.getNextBlock()!==n){let s=e.getInputWithBlock(n);const r=t.getInput(s.name);r&&(s=r.connection.connect(n.outputConnection))}else p(t).nextConnection&&p(t).nextConnection.connect(n.previousConnection)})),a&&o.connect(a),n&&e.dispose(),t}n.d(t,"j",(function(){return s})),n.d(t,"f",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return _})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return g}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"getParseTree",(function(){return getParseTree})),__webpack_require__.d(__webpack_exports__,"handleParseTreeToBlocks",(function(){return handleParseTreeToBlocks})),__webpack_require__.d(__webpack_exports__,"parseAndConvertToBlocks",(function(){return parseAndConvertToBlocks})),__webpack_require__.d(__webpack_exports__,"workspaceToLanguageCode",(function(){return workspaceToLanguageCode})),__webpack_require__.d(__webpack_exports__,"workspaceToXML",(function(){return workspaceToXML}));var _grammar_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_tokenizer_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9),_parser_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13),_parse_tree_block_connector_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10),_block_interpretations_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(7),_block_evaluator_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(11),_block_generator_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(8),_block_converters_javascript_text_exact_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(12),_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(0);Blockly.COLLAPSE_CHARS=200;const isMobile=Blockly.utils.userAgent.MOBILE||Blockly.utils.userAgent.ANDROID||Blockly.utils.userAgent.IPAD,getParseTree=function(e){console.warn("Attempting to parse",e);const t=T2C.MSG&&T2C.MSG.currentLanguage===T2C.MSG.PY?e.replace(/[\r\n]+/g,";"):e,n=shared.parser.parseBottomUpCYK(t,shared.parseTreeBlockConnector)[0];return n&&console.log("Parse Tree:",n),n},handleParseTreeToBlocks=function(e,t,n=!0,s=null){s=s||shared.workspace;const r=shared.evaluator.evaluate(e);console.log("Evaluation: ",r,t),t=t||Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.e)(s);const o=Object(_block_generator_js__WEBPACK_IMPORTED_MODULE_6__.a)(r,t,n);return console.log(o),o},parseAndConvertToBlocks=function(e,t){if(console.warn(t.type,t),!this.isCollapsed()&&(e.updateAutocomplete&&e.updateAutocomplete(this.getFieldValue("EXP"),e.OPTIONS,e.shownOPTIONS,e=>(console.warn("Parsing Partial",e),shared.parser.parseBottomUpCYK(e,shared.parseTreeBlockConnector).length>0)),this.getFieldValue("AUTOCPLT")&&Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.h)(this,this.getFieldValue("AUTOCPLT")+"\n","EXP"),e.editing&&(this.getFieldValue("EXP").endsWith("\r")||this.getFieldValue("EXP").endsWith("\n"))||e.editing&&"workspaceClick"===t.element)){const n=getParseTree(this.getFieldValue("EXP"));if(n){e.editing=!1;const t=handleParseTreeToBlocks(n,this,!1);shared.workspace.getAllBlocks().filter(e=>!e.getParent()&&("code_expression"===e.type||"code_statement"===e.type)).forEach(e=>e.dispose());let s=shared.workspace.getAllBlocks().find(e=>"code_expression"===e.type||"code_statement"===e.type);if(s)Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.a)(shared.workspace),s=shared.workspace.getAllBlocks().find(e=>"code_expression"===e.type||"code_statement"===e.type),isMobile||s.getField("EXP").showEditor_();else{console.warn("Replacing block",t);let e=Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.b)(t),n=Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.e)(shared.workspace,"code_statement");e.nextConnection&&Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.i)(e,n),Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.f)(shared.workspace),Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.a)(shared.workspace),n=shared.workspace.getAllBlocks().find(e=>"code_statement"===e.type),isMobile||n.getField("EXP").showEditor_()}}else e.editing&&"workspaceClick"===t.element&&alert("There seems to be a problem with the code you entered.  Check that your spelling is correct, that you use lowercase and capital letters as required, that every open parenthesis ( has a matching closed one ), that you use quotation marks as needed, and other potential issues with syntax.")}};function varsToLets(e){var t=e.search(/^\s*var|[\r\n]\s*var/),n=e.indexOf("var",t)+4,s=e.indexOf(";",n),r=[],o=e;return-1!==t&&(r=e.substring(n,s).split(", "),o=e.substring(0,n-4)+e.substring(s+1)),r.forEach((function(e){o=o.replace("\n"+e+" = ","\nlet "+e+" = ")})),o.trim()}const workspaceToLanguageCode=function(e,t){const n=t===T2C.MSG.PY?"Python":"JavaScript";Blockly.Python.tempFinish=Blockly.Python.finish,Blockly.Python.finish=e=>e;const s=e.getAllBlocks(),r=s.map(e=>e.getCommentText());s.forEach(e=>e.setCommentText(null));const o=Blockly[n].workspaceToCode(e||Blockly.getMainWorkspace());return Blockly.Python.finish=Blockly.Python.tempFinish,s.forEach((e,t)=>e.setCommentText(r[t])),"Python"===n?o:varsToLets(o)},workspaceToXML=function(e){const t=Blockly.Xml.workspaceToDom(e||Blockly.getMainWorkspace());return Blockly.Xml.domToPrettyText(t)},shared=function(){const init=()=>{window.addEventListener("DOMContentLoaded",e=>{if(document.getElementById("blockly-div").getAttribute("hasWorkspace"))return;document.getElementById("blockly-div").setAttribute("hasWorkspace",!0),shared.toolbox=document.getElementById("toolbox");const t={toolbox:toolbox,collapse:!0,comments:!1,disable:!1,maxBlocks:1/0,trashcan:!0,horizontalLayout:!0,toolboxPosition:"start",css:!0,media:"https://blockly-demo.appspot.com/static/media/",rtl:!1,scrollbars:!0,sounds:!0,oneBasedIndex:!0,zoom:{controls:!0,startScale:Math.min(window.innerWidth/800,1),minScale:Math.min(window.innerWidth/800,.3)}};shared.workspace=Blockly.inject("blockly-div",t),console.warn(shared.workspace.getWidth()),Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.e)(shared.workspace,"code_statement"),Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.f)(shared.workspace);const n=shared.workspace.getAllBlocks().find(e=>"code_statement"===e.type);isMobile||n.getField("EXP").showEditor_();const s=function(){const e=document.getElementById("language").value;T2C.MSG.currentLanguage=T2C.MSG[e.toUpperCase()],updateToolbox(T2C.MSG.currentLanguage),Blockly.Msg.VARIABLES_SET=T2C.MSG.currentLanguage===T2C.MSG.PY?"%1 = %2":"let %1 = %2;",updateTexts(),Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.f)(shared.workspace||Blockly.getMainWorkspace()),document.getElementById("outputAppearsBelow").innerText=T2C.MSG.currentLanguage.HEADING_OUTPUT_APPEARS_BELOW,document.getElementById("bottomText")&&(document.getElementById("bottomText").innerText=T2C.MSG.currentLanguage.HEADING_BOTTOM_TEXT)};if(window.location&&"string"==typeof window.location.href){const e=window.location.href.indexOf("lang=")+5,t=window.location.href.substring(e,e+2);4!==e&&(document.getElementById("language").value=t,s())}window.addEventListener("resize",(function(){document.getElementById("top-header").style.height=Math.max(.1*window.innerHeight,50)+"px",document.getElementById("all-content").style.height=Math.min(.9*window.innerHeight,window.innerHeight-50)+"px",Blockly.svgResize(shared.workspace)})),document.getElementById("language").addEventListener("change",(function(){s();const e=shared.workspace||Blockly.getMainWorkspace();e.getAllBlocks().forEach(_block_converters_javascript_text_exact_js__WEBPACK_IMPORTED_MODULE_7__.a),Object(_block_utility_functions_js__WEBPACK_IMPORTED_MODULE_8__.f)(e)})),document.getElementById("run-code-button")&&(document.getElementById("run-code-button").addEventListener("click",(function(){document.getElementById("output-container").classList.remove("hide-container"),document.getElementById("output-container").classList.add("show-container"),document.getElementById("consoleDisplay")&&(document.getElementById("consoleDisplay").textContent=""),T2C.MSG.currentLanguage===T2C.MSG.PY&&(T2C.MSG.currentLanguage=T2C.MSG.JS),document.getElementById("textCodeBox").value=runCode(),T2C.MSG.currentLanguage=T2C.MSG[document.getElementById("language").value.toUpperCase()],document.getElementById("xmlData").value=generateXML()})),document.getElementById("save-code-button").addEventListener("click",(function(){document.getElementById("text-code-container").classList.remove("hide-container"),document.getElementById("text-code-container").classList.add("show-container"),document.getElementById("textCodeBox").value=generateCode(),document.getElementById("xmlData").value=generateXML(),document.getElementById("load-save-text-code").textContent=T2C.MSG.currentLanguage.BUTTON_SAVE_TEXT_CODE,document.getElementById("load-save-xml").textContent=T2C.MSG.currentLanguage.BUTTON_SAVE_XML})),document.getElementById("load-code-button").addEventListener("click",(function(){document.getElementById("text-code-container").classList.remove("hide-container"),document.getElementById("text-code-container").classList.add("show-container"),document.getElementById("textCodeBox").value="",document.getElementById("xmlData").value="",document.getElementById("load-save-text-code").textContent=T2C.MSG.currentLanguage.BUTTON_LOAD_TEXT_CODE,document.getElementById("load-save-xml").textContent=T2C.MSG.currentLanguage.BUTTON_LOAD_XML})),document.getElementById("load-save-text-code").addEventListener("click",(function(){if(document.getElementById("load-save-text-code").textContent===T2C.MSG.currentLanguage.BUTTON_LOAD_TEXT_CODE){const e=T2C.MSG.currentLanguage.CONFIRM_CONVERT_TEXT_TO_BLOCKS,t=getParseTree(document.getElementById("textCodeBox").value);t&&confirm(e)?(shared.workspace.clear(),handleParseTreeToBlocks(t)):t||alert("There seems to be a problem with the code you entered.  Check that your spelling is correct, that you use lowercase and capital letters as required, that every open parenthesis ( has a matching closed one ), that you use quotation marks as needed, and other potential issues with syntax.")}else{const e=document.getElementById("textCodeBox").value;navigator.clipboard.writeText(e).then((function(){alert("Code successfully copied to clipboard")}),(function(){document.getElementById("textCodeBox").select(),alert("Code unable to be copied to clipboard.  Please do this manually.")}))}})),document.getElementById("load-save-xml").addEventListener("click",(function(){if(document.getElementById("load-save-xml").textContent===T2C.MSG.currentLanguage.BUTTON_LOAD_XML)generateBlocksFromXML();else{const e=document.getElementById("xmlData").value;navigator.clipboard.writeText(e).then((function(){alert("XML successfully copied to clipboard")}),(function(){document.getElementById("xmlData").select(),alert("XML unable to be copied to clipboard.  Please do this manually.")}))}})),document.getElementById("output-container").addEventListener("click",(function(e){"table-cell"===e.target.className&&(document.getElementById("output-container").classList.remove("show-container"),document.getElementById("output-container").classList.add("hide-container"))})),document.getElementById("text-code-container").addEventListener("click",(function(e){"table-cell"===e.target.className&&(document.getElementById("text-code-container").classList.remove("show-container"),document.getElementById("text-code-container").classList.add("hide-container"))})))});const e=new _tokenizer_js__WEBPACK_IMPORTED_MODULE_1__.a(_grammar_js__WEBPACK_IMPORTED_MODULE_0__.b);return{lexer:e,parser:new _parser_js__WEBPACK_IMPORTED_MODULE_2__.a(e,_grammar_js__WEBPACK_IMPORTED_MODULE_0__.a,Object.keys(_block_interpretations_js__WEBPACK_IMPORTED_MODULE_4__.a).concat("statement")),parseTreeBlockConnector:new _parse_tree_block_connector_js__WEBPACK_IMPORTED_MODULE_3__.a,evaluator:new _block_evaluator_js__WEBPACK_IMPORTED_MODULE_5__.a(_block_interpretations_js__WEBPACK_IMPORTED_MODULE_4__.a)}},shared=init();function varsToLets(e){var t=e.indexOf("var")+4,n=e.indexOf(";",t),s=[],r=e;return t>3&&(s=e.substring(t,n).split(", "),r=e.substring(0,t-4)+e.substring(n+1)),s.forEach((function(e){r=r.replace("\n"+e+" = ","\nlet "+e+" = ")})),r.trim()}function generateCode(){return workspaceToLanguageCode(shared.workspace,T2C.MSG.currentLanguage)}function generateXML(){return workspaceToXML(shared.workspace)}function generateBlocksFromXML(){var e=shared.workspace||Blockly.getMainWorkspace(),t=document.getElementById("xmlData").value,n=null;try{n=Blockly.Xml.textToDom(t)}catch(e){if(!window.confirm(e))return}n&&(e.clear(),Blockly.Xml.domToWorkspace(n,e)),Blockly.svgResize(e)}function runCode(){const code=generateCode();console.realLog=console.log;try{document.getElementById("consoleDisplay").textContent="",console.log=function(){document.getElementById("consoleDisplay").appendChild(document.createTextNode(Array.prototype.join.call(arguments," ")+"\n"))},eval(code)}catch(e){-1!=e.toString().indexOf("Reference")?alert(e.toString()+"\nMake sure variables are defined before they're used.  This means the variable definition let ____ = ____ needs to appear ABOVE."):alert(e.toString())}return console.log=console.realLog,code}function updateToolbox(e){shared.workspace.updateToolbox(shared.toolbox)}function updateTexts(){document.getElementById("text-code-container").querySelectorAll("textarea").forEach(e=>{e.placeholder=T2C.MSG.currentLanguage[e.name]})}return shared}()},function(e,t,n){"use strict";t.a=class{constructor(e,t){this.lhs_=e,this.rhs_=t}get lhs(){return this.lhs_}get rhs(){return this.rhs_}}},function(e,t,n){"use strict";class s{static oneStartsWithOther_(e,t,n=!1){const s=n?e:e.toLowerCase(),r=n?t:t.toLowerCase();return s.startsWith(r)||r.startsWith(s)}static getAfter_(e,t){if(s.oneStartsWithOther_(e,t))return t.substring(Math.min(e.length,t.length))}static equalsTerminal(e){return Object.values(T2C.MSG).find(t=>Object.keys(t).find(n=>n.toUpperCase().startsWith("TERMINAL_")&&t[n]===e))}static escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}static getAfterTerminal_(e,t){const n=Object.values(T2C.MSG).map(e=>e["TERMINAL_"+t.toUpperCase()]).filter(e=>"string"==typeof e),r=e.match(/^\s*/)[0];let o;e.match(/\s*$/)[0];const i=n.find(t=>o=e.match(RegExp("^\\s*"+s.escapeRegExp(t)))||(r+t).match(RegExp("^\\s*"+s.escapeRegExp(e)))),a=i&&o[0];if("string"==typeof i)return{terminal:i,remaining:s.getAfter_(a,e),match:a}}static getTerminalIndexForSymbol(e,t){if(-1!==["[","(","."].indexOf(s.getExpected(e[t])))return t-1;if(-1!==[")","]"].indexOf(s.getExpected(e[t]))){const n=[];for(let r=0;r<t;r++){const t=s.getExpected(e[r]);if("("===t||"["===t)n.push(r);else if(-1!==[")","]"].indexOf(t)){const r=s.getExpected(e[n[n.length-1]]);console.assert(["(","["].indexOf(r)===[")","]"].indexOf(t),"Opening bracket/parenthesis not closed in type-in-code blockpattern."),n.pop()}}return n[n.length-1]-1}}static getBlocksInBlueprint(e,t={}){if("block"===e.type){const n=e.value.type||e.value.types&&e.value.types[0],r=e.value.inputs;n&&(t[n]=++t[n]||1),Array.isArray(r)&&r.forEach(e=>s.getBlocksInBlueprint(e,t))}else if("input"===e.type)s.getBlocksInBlueprint(e.value,t);else if("component"===e.type&&T2C.MatchManagers[e.name])if("function"==typeof T2C.MatchManagers[e.name].getBlocksInMatch)T2C.MatchManagers[e.name].getBlocksInBlueprint(e.value,t);else{const n=s.getMatchResult(null,e);console.warn("Component Match",s.getRemainingToolboxBlocks(n,t))}return t}static getRemainingToolboxBlocks(e,t={}){return e.filter(e=>e.remainingBlueprint).map(e=>e.remainingBlueprint).forEach(e=>s.getBlocksInBlueprint(e,t)),t}static getMaxInstancesFromMatch(e,t={}){const n=s.getCorrectBlocksFromMatch(e);s.getRemainingToolboxBlocks(e,t),n.forEach(e=>t[e.type]=++t[e.type]||1)}static getCorrectBlockMatchItems(e){return e.filter(e=>e.match instanceof Blockly.Block&&"block"===e.type)}static getCorrectBlocksFromMatch(e){return s.getCorrectBlockMatchItems(e).map(e=>e.match)}static getTextToParseFromMatch(e,t=!1){return e.map(e=>e.length&&1!==e.length||"string"!=typeof e.match||!e.isMatchComplete&&!t?"":e.match).join("")}static makeErrorMatch_(e,t,n){return{id:t,expected:n,length:0,match:null,remaining:e,isMatchComplete:!1,hasError:!0}}static getExpected(e){return null==e?e:[e.value,e.match,e.expected,e].find(e=>"string"==typeof e)}static getSequentialMatchResult_(e,t){let n=[],r=[{match:null,remaining:e,hasError:!1,isMatchComplete:!0}],o=-1;for(;o<t.length-1&&r[r.length-1].remaining&&!r[r.length-1].hasError&&r[r.length-1].isMatchComplete;){++o;const e=r[r.length-1].remaining;r=s.getMatchResult(e,t[o]),n.push(...r)}if(!r[r.length-1].remaining&&r[r.length-1].isMatchComplete)for(;o<t.length-1&&t[++o]&&"regexp"===t[o].type&&t[o].token.test("");)n.push({match:"",hasError:!1,remaining:"",isMatchComplete:!0});return[{id:t.id,match:t.value,type:t.type,length:n.length+1,remaining:null,isMatchComplete:o===t.length-1&&n.every(e=>e.isMatchComplete),hasError:n.some(e=>e.hasError)}].concat(n)}static getMatchResult(e,t){if("component"===t.type){const n=T2C.MatchManagers[t.name].getMatchResult(e,t.value);return[{id:t.id,match:e,length:n.length+1,remaining:n.length>0?n[n.length-1].remaining:null,isMatchComplete:n.every(e=>e.isMatchComplete),hasError:n.some(e=>e.hasError)}].concat(n)}if("block"===t.type){if(e instanceof Blockly.Block&&(e.type===t.value.type||Array.isArray(t.value.types)&&t.value.types.includes(e.type))){const n=t.value.inputs.map(t=>e.getInput(t.name)),r=t.value.fields.map(t=>e.getField(t.name)),o=s.getMatchResult(n.concat(r),{type:"Array",value:t.value.inputs.concat(t.value.fields)});return[{id:t.id,match:e,length:o.length+1,remaining:null,type:"block",isMatchComplete:o.every(e=>e.isMatchComplete),hasError:!1}].concat(o)}return[{id:t.id,match:null,length:0,remaining:e,remainingBlueprint:t,hasError:null!=e,isMatchComplete:!1}]}if("input"===t.type){if(e instanceof Blockly.Input&&e.name===t.name){const n=s.getMatchResult(e.connection&&e.connection.targetBlock(),t.value);return[{id:t.id,match:e,length:n.length+1,remaining:null,isMatchComplete:!0,hasError:!1}].concat(n)}return[{id:t.id,match:null,length:0,remaining:e,hasError:null!=e,isMatchComplete:!1}]}if("field"===t.type){if(e instanceof Blockly.Field&&e.name===t.name){const n=s.getMatchResult(t.useText?e.getText():e.getValue(),t.value);return[{id:t.id,expected:s.getExpected(t.value),match:e,length:n.length+1,remaining:n[n.length-1].remaining,isMatchComplete:n.every(e=>e.isMatchComplete),hasError:""!==e.getValue()&&n.some(e=>e.hasError)}].concat(n)}return[{id:t.id,match:null,length:0,remaining:e,hasError:null!=e,isMatchComplete:!1}]}if("property"===t.type)return t.property,s.makeErrorMatch_(e,id);if("exact"===t.type){const n=t.property?e[t.name]:e;let r=t.value;const o=[{id:t.id,expected:s.getExpected(r),match:null,remaining:n,hasError:!0,isMatchComplete:!1}];if("string"==typeof n&&"string"==typeof r){let e=r.match(/^\s*/)[0],s=n.match(/^\s*/)[0],i=n.substring(s.length),a=r.substring(e.length);return r.match(/\s*$/)[0],n.match(/\s*$/)[0],(s.endsWith(e)||t.partial&&!i)&&(!i||i.startsWith(a)||t.partial&&a.startsWith(i))&&(t.postfix||!i.substring(Math.min(a.length,i.length)).trim())?a.length>i.length?[{id:t.id,match:n,remaining:"",hasError:!1,isMatchComplete:!1}]:[{id:t.id,match:s+a,remaining:n.substring(s.length+a.length),hasError:!1,isMatchComplete:!0}]:o}return n===r?[{id:t.id,match:n,remaining:null,hasError:!1,isMatchComplete:!1}]:o}if("includes"===t.type){const n=t.property?e[t.name]:e;return"function"==typeof n.includes&&n.includes(t.value)?[{id:t.id,match:n,remaining:null,hasError:!1,isMatchComplete:!0}]:[{id:t.id,expected:s.getExpected(t.value),match:null,remaining:n,hasError:null!=n&&""!==n,isMatchComplete:!1}]}if("or"===t.type){const n=s.getBestMatchWithIndex_(e,t.value,t.comparer),r=n.matchArr;return[{id:t.id,match:n.pattern,index:n.index,length:n.matchArr.length+1,remaining:null,hasError:r.some(e=>e.hasError),isMatchComplete:!0}].concat(n.matchArr)}if("Array"===t.type){if("string"==typeof e)return s.getSequentialMatchResult_(e,t.value);console.assert(Array.isArray(t.value));const n=t.value.map((t,n)=>s.getMatchResult(e[n],t)),r=n.flat();return[{id:t.id,match:t.value,type:t.type,length:r.length+1,remaining:null,isMatchComplete:r.every(e=>e.isMatchComplete),hasError:n.some(e=>e.hasError)}].concat(r)}if("regexp"===t.type){const n=e.toString(),r=n.match(/^\s*/)[0];let o,i=!1,a="";for(;!(o=(a+n).match(t.token))&&a!==r;)r+=" ";if(o)i=!0;else if(void 0!==t.tokenPartial)for(a="";!(o=(a+n).match(t.tokenPartial))&&a!==r;)r+=" ";return o?[{id:t.id,expected:t.token,match:o[0],length:1,remaining:n.substring(r.length+o[0].trim().length),isMatchComplete:i,hasError:!1}]:[s.makeErrorMatch_(e,t.id,t.token)]}if("terminal"===t.type&&!(e instanceof Blockly.Block)){const n=s.getAfterTerminal_(e,t.token);return[{id:t.id,expected:T2C.MSG.currentLanguage["TERMINAL_"+t.token.toUpperCase()],terminal:n?n.terminal:null,match:n?n.match:null,remaining:n?n.remaining:e,hasError:!n,isMatchComplete:n&&n.match.includes(n.terminal)}]}}static getNonEmptyMatchLength_(e){return e.filter(e=>null!=e.match&&""!=e.match).length}static getBestMatchWithIndex_(e,t,n){return n="function"==typeof n?n:(e,t)=>s.getNonEmptyMatchLength_(e)>s.getNonEmptyMatchLength_(t)||!e.hasError&&t.hasError,t.reduce((t,r,o)=>{const i=s.getMatchResult(e,r);return 0===o||n(i,t.matchArr)?{index:o,pattern:r,matchArr:i}:t},{index:-1,matchArr:[],pattern:{}})}}t.a=s},function(e,t,n){"use strict";function s(e,t,n){return e instanceof Array&&t instanceof Array?e.reduce((e,s)=>e.concat(t.map(e=>n?s.concat(e):[s,e])),[]):[]}function r(e){return 0===e.length?[]:1===e.length?e[0].map(e=>[e]):e.reduce((e,t,n)=>s(e,t,n>1))}n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";class s{constructor(e){this.blockTemplate_=JSON.parse(e),this.args_=[],this.blockVal_=null}set args(e){this.args_=e,this.blockVal_=this.evaluate_(this.blockTemplate_)}evaluate_(e){if(e instanceof s)return e;if("string"==typeof e){const t=e.split(/(%\d+)/).map(e=>{const t=e.startsWith("%")&&parseInt(e.substring(1));return t?this.evaluate_(this.args_[t-1]):e});return t.find(e=>e instanceof s)||t.join("")}if(Array.isArray(e))return e.map(this.evaluate_.bind(this));{const t={};return Object.keys(e).forEach(n=>{t[n]=this.evaluate_(e[n])}),t}}get type(){return this.blockVal_&&this.blockVal_.type}get inputs(){return this.blockVal_&&this.blockVal_.inputs}get fields(){return this.blockVal_&&this.blockVal_.fields}get blocks(){return this.blockVal_&&this.blockVal_.blocks}hasBeenSet_(e){return!/"%(\d+)"/.test(e)}keys(e){return this.blockVal_[e].filter(e=>this.hasBeenSet_(e))}}t.a=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));const s=JSON.parse('{"rules":{"wholeNumberExp":{"wholeNumberSum":["wholeNumberExp","wholeNumberAddMinusOp","wholeNumberTerm"],"wholeNumberTermSingle":["wholeNumberTerm"],"__2__wholeNumberSum":["wholeNumberExp","wholeNumberAddMinusOp"]},"wholeNumberTerm":{"wholeNumberTermSingleGroupedExp":["openParenthesis","wholeNumberTerm","closeParenthesis"],"wholeNumberTermTwoGroupedExp":["openParenthesis","wholeNumberExp","wholeNumberGroupedOp","wholeNumberTerm","closeParenthesis"],"wholeNumberTermProduct":["wholeNumberTerm","wholeNumberTimesDividedByOp","wholeNumberTerm"],"wholeNumberTermAtomic":["wholeNumberAtomic"],"__2__wholeNumberTermSingleGroupedExp":["openParenthesis","wholeNumberTerm"],"__2__wholeNumberTermTwoGroupedExp":["openParenthesis","wholeNumberExp"],"__3__wholeNumberTermTwoGroupedExp":["openParenthesis","wholeNumberExp","wholeNumberGroupedOp"],"__4__wholeNumberTermTwoGroupedExp":["openParenthesis","wholeNumberExp","wholeNumberGroupedOp","wholeNumberTerm"],"__2__wholeNumberTermProduct":["wholeNumberTerm","wholeNumberTimesDividedByOp"]},"wholeNumberAtomic":{"wholeNumberLiteral":"token_","identifierGet":["identifier"],"wholeNumberStringFunc":["stringExpWholeNumber"]},"wholeNumberGroupedOp":{"wholeNumberSumTwo":["wholeNumberAddMinusOp"],"wholeNumberProductTwo":["wholeNumberTimesDividedByOp"]},"wholeNumberAddMinusOp":{"wholeNumberPlus":"+","wholeNumberMinus":"-"},"wholeNumberTimesDividedByOp":{"wholeNumberTimes":"*","wholeNumberDividedBy":"/"},"expression":{"expressionText":["stringExp"],"expressionNumber":["wholeNumberExp"]},"statement":{"statementSingle":["expression"],"statementVariable":["variableStatement"],"statementPrint":["stringDisplay"],"statementSemicolon":["statement","semicolon"],"statementBlockExp":["expression","statementSeparator","statement"],"statementBlockVariable":["variableStatement","statementSeparator","statement"],"statementBlockPrint":["stringDisplay","statementSeparator","statement"]},"statementSeparator":{"semicolonEnd":["semicolon"],"newLineEnd":["newLine"],"carriageReturnEnd":["carriageReturn"],"semicolonMultiSeparator":["semicolon","statementSeparator"],"newLineMultiSeparator":["newLine","statementSeparator"],"carriageReturnMultiSeparator":["carriageReturn","statementSeparator"]},"semicolon":"token_","newLine":"\\n","carriageReturn":"\\r","stringExp":{"identifierGet":["identifier"],"stringGetInputExp":["stringGetInput","openParenthesis","stringExp","closeParenthesis"],"js_stringGetInputExp":["stringPrompt","openParenthesis","stringExp","closeParenthesis"],"stringGroupedExp":["openParenthesis","stringExp","closeParenthesis"],"stringConcatenationFullExpression":["stringExp","plusStr","stringExp"],"stringCharAtFullExpression":["stringExp","dot","getCharacterNumber","openParenthesis","wholeNumberExp","closeParenthesis"],"py_stringCharAtFullExpression":["stringExp","openBracket","wholeNumberExp","closeBracket"],"js_stringCharAtFullExpression":["stringExp","dot","getCharacterNumberJS","openParenthesis","wholeNumberExp","closeParenthesis"],"stringAfterTextFullExpression":["stringExp","dot","getAfterText","openParenthesis","stringExp","closeParenthesis"],"stringBeforeTextFullExpression":["stringExp","dot","getBeforeText","openParenthesis","stringExp","closeParenthesis"],"stringSubstringFullExpression":["stringExp","dot","getTextFrom","openParenthesis","wholeNumberExp","closeParenthesis","dot","getTextTo","openParenthesis","wholeNumberExp","stringSubstringCloseParenthesisOptionalTail"],"py_stringSubstringFullExpression":["stringExp","openBracket","wholeNumberExp","colon","wholeNumberExp","closeBracket"],"js_stringSubstringFullExpression":["stringExp","dot","getSubstringJS","openParenthesis","wholeNumberExp","comma","wholeNumberExp","closeParenthesis"],"stringLiteral":"token_","__2__stringGetInputExp":["stringGetInput","openParenthesis"],"__3__stringGetInputExp":["stringGetInput","openParenthesis","stringExp"],"__2__js_stringGetInputExp":["stringPrompt","openParenthesis"],"__3__js_stringGetInputExp":["stringPrompt","openParenthesis","stringExp"],"__2__stringGroupedExp":["openParenthesis","stringExp"],"__2__stringConcatenationFullExpression":["stringExp","plusStr"],"__2__stringCharAtFullExpression":["stringExp","dot"],"__3__stringCharAtFullExpression":["stringExp","dot","getCharacterNumber"],"__4__stringCharAtFullExpression":["stringExp","dot","getCharacterNumber","openParenthesis"],"__5__stringCharAtFullExpression":["stringExp","dot","getCharacterNumber","openParenthesis","wholeNumberExp"],"__2__py_stringCharAtFullExpression":["stringExp","openBracket"],"__3__py_stringCharAtFullExpression":["stringExp","openBracket","wholeNumberExp"],"__2__js_stringCharAtFullExpression":["stringExp","dot"],"__3__js_stringCharAtFullExpression":["stringExp","dot","getCharacterNumberJS"],"__4__js_stringCharAtFullExpression":["stringExp","dot","getCharacterNumberJS","openParenthesis"],"__5__js_stringCharAtFullExpression":["stringExp","dot","getCharacterNumberJS","openParenthesis","wholeNumberExp"],"__2__stringAfterTextFullExpression":["stringExp","dot"],"__3__stringAfterTextFullExpression":["stringExp","dot","getAfterText"],"__4__stringAfterTextFullExpression":["stringExp","dot","getAfterText","openParenthesis"],"__5__stringAfterTextFullExpression":["stringExp","dot","getAfterText","openParenthesis","stringExp"],"__2__stringBeforeTextFullExpression":["stringExp","dot"],"__3__stringBeforeTextFullExpression":["stringExp","dot","getBeforeText"],"__4__stringBeforeTextFullExpression":["stringExp","dot","getBeforeText","openParenthesis"],"__5__stringBeforeTextFullExpression":["stringExp","dot","getBeforeText","openParenthesis","stringExp"],"__2__stringSubstringFullExpression":["stringExp","dot"],"__3__stringSubstringFullExpression":["stringExp","dot","getTextFrom"],"__4__stringSubstringFullExpression":["stringExp","dot","getTextFrom","openParenthesis"],"__5__stringSubstringFullExpression":["stringExp","dot","getTextFrom","openParenthesis","wholeNumberExp"],"__6__stringSubstringFullExpression":["stringExp","dot","getTextFrom","openParenthesis","wholeNumberExp","closeParenthesis"],"__7__stringSubstringFullExpression":["stringExp","dot","getTextFrom","openParenthesis","wholeNumberExp","closeParenthesis","dot"],"__8__stringSubstringFullExpression":["stringExp","dot","getTextFrom","openParenthesis","wholeNumberExp","closeParenthesis","dot","getTextTo"],"__9__stringSubstringFullExpression":["stringExp","dot","getTextFrom","openParenthesis","wholeNumberExp","closeParenthesis","dot","getTextTo","openParenthesis"],"__10__stringSubstringFullExpression":["stringExp","dot","getTextFrom","openParenthesis","wholeNumberExp","closeParenthesis","dot","getTextTo","openParenthesis","wholeNumberExp"],"__2__py_stringSubstringFullExpression":["stringExp","openBracket"],"__3__py_stringSubstringFullExpression":["stringExp","openBracket","wholeNumberExp"],"__4__py_stringSubstringFullExpression":["stringExp","openBracket","wholeNumberExp","colon"],"__5__py_stringSubstringFullExpression":["stringExp","openBracket","wholeNumberExp","colon","wholeNumberExp"],"__2__js_stringSubstringFullExpression":["stringExp","dot"],"__3__js_stringSubstringFullExpression":["stringExp","dot","getSubstringJS"],"__4__js_stringSubstringFullExpression":["stringExp","dot","getSubstringJS","openParenthesis"],"__5__js_stringSubstringFullExpression":["stringExp","dot","getSubstringJS","openParenthesis","wholeNumberExp"],"__6__js_stringSubstringFullExpression":["stringExp","dot","getSubstringJS","openParenthesis","wholeNumberExp","comma"],"__7__js_stringSubstringFullExpression":["stringExp","dot","getSubstringJS","openParenthesis","wholeNumberExp","comma","wholeNumberExp"]},"stringExpWholeNumber":{"stringFindFirstFullExpression":["stringExp","dot","findFirstOccurrenceOfText","openParenthesis","stringExp","stringFindFirstCloseParenthesisOptionalTail"],"js_stringFindFirstFullExpression":["stringExp","dot","jsIndexOf","openParenthesis","stringExp","closeParenthesis"],"stringExpLength":["stringExp","dot","length"],"py_stringExpLength":["len","openParenthesis","stringExp","closeParenthesis"],"__2__stringFindFirstFullExpression":["stringExp","dot"],"__3__stringFindFirstFullExpression":["stringExp","dot","findFirstOccurrenceOfText"],"__4__stringFindFirstFullExpression":["stringExp","dot","findFirstOccurrenceOfText","openParenthesis"],"__5__stringFindFirstFullExpression":["stringExp","dot","findFirstOccurrenceOfText","openParenthesis","stringExp"],"__2__js_stringFindFirstFullExpression":["stringExp","dot"],"__3__js_stringFindFirstFullExpression":["stringExp","dot","jsIndexOf"],"__4__js_stringFindFirstFullExpression":["stringExp","dot","jsIndexOf","openParenthesis"],"__5__js_stringFindFirstFullExpression":["stringExp","dot","jsIndexOf","openParenthesis","stringExp"],"__2__stringExpLength":["stringExp","dot"],"__2__py_stringExpLength":["len","openParenthesis"],"__3__py_stringExpLength":["len","openParenthesis","stringExp"]},"stringDisplay":{"js_ConsoleLogStatement":["console","dot","log","openParenthesis","expression","closeParenthesis"],"displayStatement":["display","openParenthesis","expression","closeParenthesis"],"__2__js_ConsoleLogStatement":["console","dot"],"__3__js_ConsoleLogStatement":["console","dot","log"],"__4__js_ConsoleLogStatement":["console","dot","log","openParenthesis"],"__5__js_ConsoleLogStatement":["console","dot","log","openParenthesis","expression"],"__2__displayStatement":["display","openParenthesis"],"__3__displayStatement":["display","openParenthesis","expression"]},"stringSubstringCloseParenthesisOptionalTail":{"stringSubstringCloseParenthesisNoTail":["closeParenthesis"],"stringSubstringCloseParenthesisTail":["closeParenthesis","dot","substringTail"],"__2__stringSubstringCloseParenthesisTail":["closeParenthesis","dot"]},"stringFindFirstCloseParenthesisOptionalTail":{"stringFindFirstCloseParenthesisNoTail":["closeParenthesis"],"stringFindFirstCloseParenthesisTail":["closeParenthesis","dot","findFirstTail"],"__2__stringFindFirstCloseParenthesisTail":["closeParenthesis","dot"]},"dot":"token_","console":"console","log":"log","display":"display","openParenthesis":"token_","closeParenthesis":"token_","openBracket":"token_","closeBracket":"token_","comma":"token_","stringGetInput":"getInputByAsking","stringPrompt":"prompt","length":"length","len":"len","getTextFrom":"getTextFromPositionNUMBER","getTextTo":"toPositionNUMBER","getSubstringJS":"substring","jsIndexOf":"indexOf","findFirstOccurrenceOfText":"positionNumberOfTEXT","findLastOccurrenceOfText":"lastPositionNumberOfTEXT","getAfterText":"getAfterTEXT","getBeforeText":"getBeforeTEXT","plusStr":"+","getCharacterNumber":"getCharacterNUMBER","getCharacterNumberJS":"charAt","toNumber":"toNumber","substringTail":"tak_paen","findFirstTail":"ke_sthiti_sankhya","variableStatement":{"variableAssignment":["variablesLet","identifier","equalsSign","expression"],"variableAssignmentNoLet":["identifier","equalsSign","expression"],"__2__variableAssignment":["variablesLet","identifier"],"__3__variableAssignment":["variablesLet","identifier","equalsSign"],"__2__variableAssignmentNoLet":["identifier","equalsSign"]},"variablesLet":"let","equalsSign":"=","identifier":"token_"},"terminals":["wholeNumberPlus","wholeNumberMinus","wholeNumberTimes","wholeNumberDividedBy","semicolon","newLine","carriageReturn","findFirstOccurrenceOfText","jsIndexOf","findLastOccurrenceOfText","getAfterText","getBeforeText","plusStr","getCharacterNumber","getCharacterNumberJS","toNumber","getTextFrom","getSubstringJS","getTextTo","stringGetInput","stringPrompt","console","log","display","length","substringTail","findFirstTail","variablesLet","equalsSign"]}'),r=JSON.parse('{"stringLiteral":{"pattern":"\\"([^\\"]*)\\"|\'([^\']*)\'","order":1},"identifier":{"pattern":"([_\\\\$A-Za-z|ऄ-ह|ऽ|ॐ|क़-ॡ|ॱ-ॿ][\\\\w\\\\$|ऀ-ॣ|०-९|ॱ-ॿ]*)","order":2},"positiveDecimal":{"pattern":"(\\\\d+\\\\.[1-9]\\\\d+)","order":3},"wholeNumberLiteral":{"pattern":"\\\\d+|\\\\d*\\\\.[0]+","order":6},"dot":{"pattern":"(\\\\.)","order":7},"openParenthesis":{"pattern":"(\\\\()","order":8},"closeParenthesis":{"pattern":"(\\\\))","order":9},"openBracket":{"pattern":"(\\\\[)","order":10},"closeBracket":{"pattern":"(\\\\])","order":11},"comma":{"pattern":"(\\\\,)","order":12},"semicolon":{"pattern":"(\\\\;)","order":13},"colon":{"pattern":"(:)","order":14},"negativeDecimalMOVEDFROMFOURFORNOW":{"pattern":"(-\\\\d+\\\\.[1-9]\\\\d+)","order":15},"negativeIntegerMOVEDFROMFIVEFORNOW":{"pattern":"-[1-9]\\\\d*|-[1-9]\\\\d*\\\\.[0]+","order":16}}')},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const s=JSON.parse('{"wholeNumberLiteral":{"type":"math_number","fields":{"NUM":"%1"}},"wholeNumberSum":{"type":"math_arithmetic_basic","fields":{"OP":"%2"},"inputs":{"A":"%1","B":"%3"}},"wholeNumberTermTwoGroupedExp":{"type":"math_arithmetic_basic","fields":{"OP":"%3"},"inputs":{"A":"%2","B":"%4"}},"wholeNumberTermProduct":{"type":"math_arithmetic_basic","fields":{"OP":"%2"},"inputs":{"A":"%1","B":"%3"}},"wholeNumberPlus":"ADD","wholeNumberMinus":"MINUS","wholeNumberTimes":"MULTIPLY","wholeNumberDividedBy":"DIVIDE","wholeNumberTermSingleGroupedExp":"%2","statementBlockExp":{"blocks":["%1","%3"]},"statementBlockVariable":{"blocks":["%1","%3"]},"statementBlockPrint":{"blocks":["%1","%3"]},"stringLiteral":{"type":"text","fields":{"TEXT":"%1"}},"stringGetInputExp":{"type":"text_input","inputs":{"TEXT":"%3"}},"js_stringGetInputExp":{"type":"js_text_input","inputs":{"TEXT":"%3"}},"displayStatement":{"type":"text_print","inputs":{"TEXT":"%3"}},"js_ConsoleLogStatement":{"type":"js_text_print","inputs":{"TEXT":"%5"}},"stringExpLength":{"type":"t2c_text_length","inputs":{"VALUE":"%1"}},"py_stringExpLength":{"type":"t2c_text_length","inputs":{"VALUE":"%3"}},"stringFindFirstFullExpression":{"type":"t2c_text_indexof","inputs":{"VALUE":"%1","FIND":"%5"}},"js_stringFindFirstFullExpression":{"type":"js_text_indexof","inputs":{"VALUE":"%1","FIND":"%5"}},"stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":"%10"}},"stringCharAtFullExpression":{"type":"%3","inputs":{"VALUE":"%1","AT":"%5"}},"py_stringCharAtFullExpression":{"type":"t2c_text_charat","inputs":{"VALUE":"%1","AT":"%3"}},"js_stringCharAtFullExpression":{"type":"js_text_charat","inputs":{"VALUE":"%1","AT":"%5"}},"py_stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%3","AT2":"%5"}},"js_stringSubstringFullExpression":{"type":"js_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":"%7"}},"stringAfterTextFullExpression":{"type":"t2c_text_after","inputs":{"TEXT":"%1","SUB":"%5"}},"stringBeforeTextFullExpression":{"type":"t2c_text_before","inputs":{"TEXT":"%1","SUB":"%5"}},"stringConcatenationFullExpression":{"type":"t2c_text_join","inputs":{"A":"%1","B":"%3"}},"stringGroupedExp":"%2","plusStr":"t2c_text_join","findFirstOccurrenceOfText":"t2c_text_indexof","getCharacterNumber":"t2c_text_charat","getCharacterNumberJS":"js_text_charat","getSubstringJS":"js_text_getsubstring","jsIndexOf":"js_text_indexof","getTextFrom":"t2c_text_getsubstring","getAfterText":"t2c_text_after","getBeforeText":"t2c_text_before","identifierGet":{"type":"variables_get","fields":{"VAR":"%1"}},"variableAssignment":{"type":"variables_set","fields":{"VAR":"%2"},"inputs":{"VALUE":"%4"}},"variableAssignmentNoLet":{"type":"variables_set","fields":{"VAR":"%1"},"inputs":{"VALUE":"%3"}},"__2__wholeNumberSum":{"type":"math_arithmetic_basic","fields":{"OP":"%2"},"inputs":{"A":"%1","B":{"type":"code_expression"}}},"__2__wholeNumberTermSingleGroupedExp":"%2","__2__wholeNumberTermTwoGroupedExp":{"type":"math_arithmetic_basic","fields":{"OP":{"type":"code_expression"}},"inputs":{"A":"%2","B":{"type":"code_expression"}}},"__3__wholeNumberTermTwoGroupedExp":{"type":"math_arithmetic_basic","fields":{"OP":"%3"},"inputs":{"A":"%2","B":{"type":"code_expression"}}},"__4__wholeNumberTermTwoGroupedExp":{"type":"math_arithmetic_basic","fields":{"OP":"%3"},"inputs":{"A":"%2","B":"%4"}},"__2__wholeNumberTermProduct":{"type":"math_arithmetic_basic","fields":{"OP":"%2"},"inputs":{"A":"%1","B":{"type":"code_expression"}}},"__2__stringGetInputExp":{"type":"text_input","inputs":{"TEXT":{"type":"code_expression"}}},"__3__stringGetInputExp":{"type":"text_input","inputs":{"TEXT":"%3"}},"__2__js_stringGetInputExp":{"type":"js_text_input","inputs":{"TEXT":{"type":"code_expression"}}},"__3__js_stringGetInputExp":{"type":"js_text_input","inputs":{"TEXT":"%3"}},"__2__stringGroupedExp":"%2","__2__stringConcatenationFullExpression":{"type":"t2c_text_join","inputs":{"A":"%1","B":{"type":"code_expression"}}},"__2__stringCharAtFullExpression":{"type":{"type":"code_expression"},"inputs":{"VALUE":"%1","AT":{"type":"code_expression"}}},"__3__stringCharAtFullExpression":{"type":"%3","inputs":{"VALUE":"%1","AT":{"type":"code_expression"}}},"__4__stringCharAtFullExpression":{"type":"%3","inputs":{"VALUE":"%1","AT":{"type":"code_expression"}}},"__5__stringCharAtFullExpression":{"type":"%3","inputs":{"VALUE":"%1","AT":"%5"}},"__2__py_stringCharAtFullExpression":{"type":"t2c_text_charat","inputs":{"VALUE":"%1","AT":{"type":"code_expression"}}},"__3__py_stringCharAtFullExpression":{"type":"t2c_text_charat","inputs":{"VALUE":"%1","AT":"%3"}},"__2__js_stringCharAtFullExpression":{"type":"js_text_charat","inputs":{"VALUE":"%1","AT":{"type":"code_expression"}}},"__3__js_stringCharAtFullExpression":{"type":"js_text_charat","inputs":{"VALUE":"%1","AT":{"type":"code_expression"}}},"__4__js_stringCharAtFullExpression":{"type":"js_text_charat","inputs":{"VALUE":"%1","AT":{"type":"code_expression"}}},"__5__js_stringCharAtFullExpression":{"type":"js_text_charat","inputs":{"VALUE":"%1","AT":"%5"}},"__2__stringAfterTextFullExpression":{"type":"t2c_text_after","inputs":{"TEXT":"%1","SUB":{"type":"code_expression"}}},"__3__stringAfterTextFullExpression":{"type":"t2c_text_after","inputs":{"TEXT":"%1","SUB":{"type":"code_expression"}}},"__4__stringAfterTextFullExpression":{"type":"t2c_text_after","inputs":{"TEXT":"%1","SUB":{"type":"code_expression"}}},"__5__stringAfterTextFullExpression":{"type":"t2c_text_after","inputs":{"TEXT":"%1","SUB":"%5"}},"__2__stringBeforeTextFullExpression":{"type":"t2c_text_before","inputs":{"TEXT":"%1","SUB":{"type":"code_expression"}}},"__3__stringBeforeTextFullExpression":{"type":"t2c_text_before","inputs":{"TEXT":"%1","SUB":{"type":"code_expression"}}},"__4__stringBeforeTextFullExpression":{"type":"t2c_text_before","inputs":{"TEXT":"%1","SUB":{"type":"code_expression"}}},"__5__stringBeforeTextFullExpression":{"type":"t2c_text_before","inputs":{"TEXT":"%1","SUB":"%5"}},"__2__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":{"type":"code_expression"},"AT2":{"type":"code_expression"}}},"__3__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":{"type":"code_expression"},"AT2":{"type":"code_expression"}}},"__4__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":{"type":"code_expression"},"AT2":{"type":"code_expression"}}},"__5__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":{"type":"code_expression"}}},"__6__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":{"type":"code_expression"}}},"__7__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":{"type":"code_expression"}}},"__8__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":{"type":"code_expression"}}},"__9__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":{"type":"code_expression"}}},"__10__stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":"%10"}},"__2__py_stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":{"type":"code_expression"},"AT2":{"type":"code_expression"}}},"__3__py_stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%3","AT2":{"type":"code_expression"}}},"__4__py_stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%3","AT2":{"type":"code_expression"}}},"__5__py_stringSubstringFullExpression":{"type":"t2c_text_getsubstring","inputs":{"STRING":"%1","AT1":"%3","AT2":"%5"}},"__2__js_stringSubstringFullExpression":{"type":"js_text_getsubstring","inputs":{"STRING":"%1","AT1":{"type":"code_expression"},"AT2":{"type":"code_expression"}}},"__3__js_stringSubstringFullExpression":{"type":"js_text_getsubstring","inputs":{"STRING":"%1","AT1":{"type":"code_expression"},"AT2":{"type":"code_expression"}}},"__4__js_stringSubstringFullExpression":{"type":"js_text_getsubstring","inputs":{"STRING":"%1","AT1":{"type":"code_expression"},"AT2":{"type":"code_expression"}}},"__5__js_stringSubstringFullExpression":{"type":"js_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":{"type":"code_expression"}}},"__6__js_stringSubstringFullExpression":{"type":"js_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":{"type":"code_expression"}}},"__7__js_stringSubstringFullExpression":{"type":"js_text_getsubstring","inputs":{"STRING":"%1","AT1":"%5","AT2":"%7"}},"__2__stringFindFirstFullExpression":{"type":"t2c_text_indexof","inputs":{"VALUE":"%1","FIND":{"type":"code_expression"}}},"__3__stringFindFirstFullExpression":{"type":"t2c_text_indexof","inputs":{"VALUE":"%1","FIND":{"type":"code_expression"}}},"__4__stringFindFirstFullExpression":{"type":"t2c_text_indexof","inputs":{"VALUE":"%1","FIND":{"type":"code_expression"}}},"__5__stringFindFirstFullExpression":{"type":"t2c_text_indexof","inputs":{"VALUE":"%1","FIND":"%5"}},"__2__js_stringFindFirstFullExpression":{"type":"js_text_indexof","inputs":{"VALUE":"%1","FIND":{"type":"code_expression"}}},"__3__js_stringFindFirstFullExpression":{"type":"js_text_indexof","inputs":{"VALUE":"%1","FIND":{"type":"code_expression"}}},"__4__js_stringFindFirstFullExpression":{"type":"js_text_indexof","inputs":{"VALUE":"%1","FIND":{"type":"code_expression"}}},"__5__js_stringFindFirstFullExpression":{"type":"js_text_indexof","inputs":{"VALUE":"%1","FIND":"%5"}},"__2__stringExpLength":{"type":"t2c_text_length","inputs":{"VALUE":"%1"}},"__2__py_stringExpLength":{"type":"t2c_text_length","inputs":{"VALUE":{"type":"code_expression"}}},"__3__py_stringExpLength":{"type":"t2c_text_length","inputs":{"VALUE":"%3"}},"__2__js_ConsoleLogStatement":{"type":"js_text_print","inputs":{"TEXT":{"type":"code_expression"}}},"__3__js_ConsoleLogStatement":{"type":"js_text_print","inputs":{"TEXT":{"type":"code_expression"}}},"__4__js_ConsoleLogStatement":{"type":"js_text_print","inputs":{"TEXT":{"type":"code_expression"}}},"__5__js_ConsoleLogStatement":{"type":"js_text_print","inputs":{"TEXT":"%5"}},"__2__displayStatement":{"type":"text_print","inputs":{"TEXT":{"type":"code_expression"}}},"__3__displayStatement":{"type":"text_print","inputs":{"TEXT":"%3"}},"__2__variableAssignment":{"type":"variables_set","fields":{"VAR":"%2"},"inputs":{"VALUE":{"type":"code_expression"}}},"__3__variableAssignment":{"type":"variables_set","fields":{"VAR":"%2"},"inputs":{"VALUE":{"type":"code_expression"}}},"__2__variableAssignmentNoLet":{"type":"variables_set","fields":{"VAR":"%1"},"inputs":{"VALUE":{"type":"code_expression"}}}}')},function(e,t,n){"use strict";n(5);var s=n(0);t.a=function(e,t,n=!0){const r=t.workspace,o=function e(t,n){var r;if(t&&t.type)return r=Object(s.e)(n,t.type),t.inputs&&Object.keys(t.inputs).forEach((function(o){Object(s.j)(r,o,e(t.inputs[o],n))})),t&&t.fields&&Object.keys(t.fields).forEach((function(e){Object(s.h)(r,t.fields[e],e)})),r;if(t&&Array.isArray(t.blocks)){for(var o=t.blocks.map(t=>e(t,n)),i=0;i<o.length-1;i++)o[i].getNextBlock()||o[i+1].getPreviousBlock()||Object(s.i)(o[i],o[i+1]);return o[0]}}(e,r);return Object(s.g)(t,o,!0),n&&Object(s.f)(r),o}},function(e,t,n){"use strict";t.a=class{constructor(e){this.tokens_=e,this.tokensRegExp_=Object.keys(e).map(t=>({key:t,value:RegExp(e[t].pattern),order:e[t].order})),this.tokensRegExp_.sort((e,t)=>e.order-t.order)}isToken(e){return!1}isTokenType(e){return-1!==Object.keys(this.tokens_).indexOf(e)}tokenize(e){const t=e=>{if(""===e.trim())return[];let n,s=0;for(;s<this.tokensRegExp_.length&&!(n=this.tokensRegExp_[s].value.exec(e));)s++;if(n){let r=n instanceof Array?n.slice(1).find(e=>null!=e):null,o=null!=r?r:e.substring(n.index,n.index+n[0].length);return t(e.substring(0,n.index)).concat([{tokenType:this.tokensRegExp_[s].key,value:o}]).concat(t(e.substring(n.index+n[0].length)))}return e.trim().split("").filter(e=>-1===e.search(/\s/)).map(e=>Object({tokenType:"none",value:e}))};return t(e)}}},function(e,t,n){"use strict";var s=n(2),r=n(4);t.a=class{convertToBlockParseTrees(e,t=1){return e.rhsides.map(n=>"string"==typeof n?[new s.a(e.lhs,n)]:Object(r.a)(n.map(e=>this.convertToBlockParseTrees(e,t))).map(t=>new s.a(e.lhs,t))).reduce((e,t)=>e.concat(t),[]).slice(0,t)}}},function(e,t,n){"use strict";var s=n(2),r=n(5);t.a=class{constructor(e){this.interpretations_=e}evaluate(e){if(null===e||e instanceof s.a){if(e){const t="string"==typeof e.rhs?[e.rhs.replace(/\"/g,"'")]:e.rhs.map(this.evaluate.bind(this)),n=this.interpretations_[e.lhs];if("string"==typeof n)return n;if(n){const e=new r.a(JSON.stringify(n));return e.args=t,e}return t[0]}return""}throw console.assert(null!==e&&!(e instanceof s.a),{msg:"Non-null is invalid root type",expectedType:s.a,actual:e}),new Error("Invalid root type")}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var s=n(0);function r(e){const t=e.workspace;"js_text_print"===e.type||"js_text_input"===e.type?Object(s.g)(e,Object(s.e)(t,e.type.substring(3)),!0):"js_text_indexof"===e.type||"js_text_charat"===e.type||"js_text_getsubstring"===e.type?Object(s.g)(e,Object(s.e)(t,e.type.replace("js","t2c")),!0):"text_length"===e.type&&Object(s.g)(e,Object(s.e)(t,"t2c_"+e.type),!0)}function o(e){const t=e.workspace;if("text_print"===e.type)Object(s.g)(e,Object(s.e)(t,"js_text_print"),!0);else if("text_input"===e.type)Object(s.g)(e,Object(s.e)(t,"js_text_input"),!0);else if("t2c_text_indexof"===e.type)Object(s.g)(e,Object(s.e)(t,"js_text_indexof"),!0);else if("t2c_text_charat"===e.type)Object(s.g)(e,Object(s.e)(t,"js_text_charat"),!0);else if("t2c_text_length"===e.type)Object(s.g)(e,Object(s.e)(t,"text_length"),!0);else if("t2c_text_getsubstring"===e.type)Object(s.g)(e,Object(s.e)(t,"js_text_getsubstring"),!0);else if("t2c_text_before"===e.type){var n=e.getInputTargetBlock("SUB"),r=e.getInputTargetBlock("TEXT"),o=null,i=Object(s.e)(t,"js_text_getsubstring"),a=Object(s.e)(t,"math_number"),l=Object(s.e)(t,"js_text_indexof");if(Object(s.h)(a,0,"NUM"),r)if("text"===r.type)o=Object(s.e)(t,r.type),Object(s.h)(o,r.getFieldValue("TEXT"),"TEXT"),l.getInput("VALUE").connection.connect(o.outputConnection),i.getInput("STRING").connection.connect(r.outputConnection);else if("variables_get"===r.type)o=Object(s.e)(t,r.type),Object(s.h)(o,r.getFieldValue("VAR"),"VAR"),l.getInput("VALUE").connection.connect(o.outputConnection),i.getInput("STRING").connection.connect(r.outputConnection);else{var c=createNewTempVariable(t),_=Object(s.e)(t,"variables_set");Object(s.h)(_,c,"VAR"),Object(s.j)(_,"VALUE",r);var u=Object(s.e)(t,"variables_get");Object(s.h)(u,c,"VAR");var p=copyBlock(u);if(Object(s.j)(l,"VALUE",p),Object(s.j)(i,"STRING",u),m=Object(s.c)(e)){var g=m.previousConnection.targetBlock();g&&_.previousConnection.connect(g.nextConnection),m.previousConnection.connect(_.nextConnection)}}n&&Object(s.j)(l,"FIND",n),Object(s.j)(i,"AT1",a),Object(s.j)(i,"AT2",l),e.outputConnection.targetConnection?e.outputConnection.targetConnection.connect(i.outputConnection):Object(s.d)(e,i),e.dispose()}else if("t2c_text_after"===e.type){e.getParent(),i=Object(s.e)(t,"js_text_getsubstring"),r=e.getInputTargetBlock("TEXT"),n=e.getInputTargetBlock("SUB"),l=Object(s.e)(t,"js_text_indexof");var h=Object(s.e)(t,"text_length"),d=Object(s.e)(t,"text_length"),T=Object(s.e)(t,"math_arithmetic_basic");if(Object(s.h)(T,"ADD","OP"),r){if("text"!==r.type&&"variables_get"!==r.type){var m,E=Object(s.e)(t,"variables_set");if(c=createNewTempVariable(t),Object(s.h)(E,c,"VAR"),Object(s.j)(E,"VALUE",r),m=Object(s.c)(e)){var x=m.previousConnection.targetBlock();x&&E.previousConnection.connect(x.nextConnection),m.previousConnection.connect(E.nextConnection)}r=Object(s.e)(t,"variables_get"),Object(s.h)(r,c,"VAR"),Object(s.j)(i,"STRING",r)}else Object(s.j)(i,"STRING",r);Object(s.j)(l,"VALUE",copyBlock(r)),Object(s.j)(h,"VALUE",copyBlock(r))}if(n){if("text"!==n.type&&"variables_get"!==n.type){var y=Object(s.e)(t,"variables_set"),f=createNewTempVariable(t);Object(s.h)(y,f,"VAR"),Object(s.j)(y,"VALUE",n);var b=Object(s.c)(e);if(b){var k=b.previousConnection.targetBlock();k&&y.previousConnection.connect(k.nextConnection),b.previousConnection.connect(y.nextConnection)}n=Object(s.e)(t,"variables_get"),Object(s.h)(n,f,"VAR")}if("variables_get"===n.type)Object(s.j)(T,"B",d),Object(s.j)(d,"VALUE",copyBlock(n));else{var B=Object(s.e)(t,"math_number");Object(s.h)(B,n.getFieldValue("TEXT").length,"NUM"),Object(s.j)(T,"B",B),d.dispose()}Object(s.j)(l,"FIND",n)}else Object(s.j)(T,"B",d);Object(s.j)(T,"A",l),Object(s.j)(i,"AT1",T),Object(s.j)(i,"AT2",h),e.outputConnection.targetConnection?e.outputConnection.targetConnection.connect(i.outputConnection):Object(s.d)(e,i),e.dispose()}}},function(e,t,n){"use strict";class s{constructor(e,t=[]){this.lhs_=e,this.rhsides_=t}merge(e,t=1){console.assert(this.lhs_===e.lhs_,{msg:"This lhs of "+this.lhs_+" does not match node's lhs of "+e.lhs_}),this.rhsides_.length<t&&this.rhsides_.push(...e.rhsides_)}get lhs(){return this.lhs_}get rhsides(){return this.rhsides_}static concatToEach(e,t,n){return new s(e,t.rhsides_.map(e=>e.concat(n)))}}var r=s;class o{constructor(e,t){this.root_=new r(e,[Array.isArray(t)?t.map(e=>e.root_):t])}rhsConcat(e,t){let n=new o(e,[]);return n.root_=r.concatToEach(e,this.root_,t.root_),n}get rootLHS(){return this.root_.lhs}static mergeForests(e){const t=e.slice();t.sort((e,t)=>e.root_.lhs===t.root_.lhs?0:e.root_.lhs<t.root_.lhs?-1:1);const n=[];for(let e=0;e<t.length;e++)0===e||n[n.length-1].root_.lhs!==t[e].root_.lhs?n.push(t[e]):n[n.length-1].root_.merge(t[e].root_);return n}parseTrees(e){return e.convertToBlockParseTrees(this.root_)}}var i=o,a=n(4);t.a=class{constructor(e,t,n){this.lexer_=e,this.createRuleSetFromGrammar_(t),n=n||[],console.warn("NEW RULE SET:",this.ruleSets_),this.terminals_=t.terminals,this.maxDepth_=0}addRule_(e,t,n){if((n=n||this.ruleSets_)[e]){let s=Array.from(n[e]).filter(e=>Array.isArray(e)).map(e=>JSON.stringify(e));Array.isArray(t)&&-1!==s.indexOf(JSON.stringify(t))||n[e].add(t)}else n[e]=new Set([t])}flattenNonessentialUnitRules_(e){const t=Object.keys(this.ruleSets_),n=t.filter(t=>-1===e.indexOf(t));console.warn("Required symbols",e),console.warn("Nonessential",n),n.forEach((e,s)=>{console.warn("Current: ",e,s,"out of",n.length,"processed");const r=Array.from(this.ruleSets_[e]).filter(e=>Array.isArray(e)&&1===e.length),o=r.map(e=>"string"==typeof e?e:e[0]);t.forEach(t=>{const n=[],s=[];Array.from(this.ruleSets_[t]).filter(e=>Array.isArray(e)).forEach(t=>{let r=[],i=!1;t.forEach((t,n)=>{t!==e?0===n?r.push([t]):r.forEach(e=>e.push(t)):(i=!0,r=0===n?o.map(e=>[e]):Object(a.b)(r,o).map(e=>e[0].concat(e[1])))}),i&&s.push(t),n.push(...r)}),n.forEach(e=>this.addRule_(t,e)),r.length===this.ruleSets_[e].size&&s.forEach(e=>{if(!this.ruleSets_[t].delete(e))throw new Error(e)})}),r.forEach(t=>{if(!this.ruleSets_[e].delete(t))throw new Error("No delete")})})}getTranslations_(e){return Object.keys(T2C.MSG).map(t=>T2C.MSG[t][Object.keys(T2C.MSG[t]).find(t=>t==="TERMINAL_"+e.toUpperCase())]).filter(e=>void 0!==e)}createRuleSetFromGrammar_(e){this.ruleSets_={},Object.keys(e.rules).forEach(t=>{const n=[t],s=e.rules[t];"string"==typeof s||s instanceof Array?("string"==typeof s&&n.push(s),this.addRule_(t,s)):Object.keys(s).forEach(e=>{this.addRule_(t,[e]),this.addRule_(e,s[e]),n.push(e),"string"==typeof s[e]&&n.push(s[e])}),n.forEach(e=>this.getTranslations_(e).forEach(e=>this.addRule_(t,e)))})}maxPathLengthToTerminalOrSplit_(e){const t=(e?[e]:Object.keys(this.ruleSets_)).map(e=>this.ruleSets_[e]?Array.from(this.ruleSets_[e]).filter(e=>Array.isArray(e)&&1===e.length&&this.ruleSets_[e[0]]).map(t=>[e].concat(this.maxPathLengthToTerminalOrSplit_(t[0]))):[e]),n=e?t[0]:[].concat(...t);return 0===n.length?[e]:n.reduce((e,t)=>e.length>t.length?e:t)}getOppositeRules_(){const e={};return Object.keys(this.ruleSets_).forEach(t=>{Array.from(this.ruleSets_[t]).forEach(n=>{if(Array.isArray(n))if(1===n.length)this.addRule_(n[0],t,e);else{let s=t;n.slice(0,n.length-1).forEach((t,r)=>{let o=n.length-r-1==1?n[0]:JSON.stringify(n.slice(0,n.length-r-1));this.addRule_(JSON.stringify([o,n[n.length-r-1]]),s,e),s=o})}else this.addRule_(n,t,e)})}),e}getUnitRules_(e,t,n){const s=[];let r=e;for(let e=0;e<n&&r.length>0;e++){let e=[];r.forEach(n=>{t[n.rootLHS]&&Array.from(t[n.rootLHS]).filter(e=>e!==n.rootLHS).forEach(t=>e.push(new i(t,[n])))}),s.push(...e),r=e}return s}parseBottomUpCYK(e,t,n="statement"){if(""===e)return[];Object.values(this.ruleSets_).reduce((e,t)=>e+t.size,0);const s=this.lexer_.tokenize(e),r=this.maxPathLengthToTerminalOrSplit_("statement"),o=this.getOppositeRules_();console.warn("TOKEN ARRAY:",s,r.length);const l=[s.map(e=>Array.from(o[e.value]||[]).concat(e.tokenType).filter((e,t,n)=>n.indexOf(e)===t).map(t=>new i(t,e.value)))];for(let e=0;e<s.length;e++)l[0][e].push(...this.getUnitRules_(l[0][e],o,r.length)),l[0][e]=i.mergeForests(l[0][e]);for(let e=1;e<s.length;e++){let t=[];for(let n=0;n<s.length-e;n++){let s=[];for(let t=0;t<e;t++){let r=Object(a.b)(l[t][n],l[e-1-t][n+t+1]);s.push(...r)}t.push(i.mergeForests(s.map(e=>({lhsides:o[JSON.stringify([e[0].rootLHS,e[1].rootLHS])],rhs:e})).filter(e=>void 0!==e.lhsides).map(e=>Array.from(e.lhsides).map(t=>e.rhs[0].rootLHS.startsWith("[")?e.rhs[0].rhsConcat(t,e.rhs[1]):new i(t,e.rhs))).reduce((e,t)=>e.concat(t),[]))),t[n].push(...this.getUnitRules_(t[n],o,r.length)),t[n]=i.mergeForests(t[n])}l.push(t)}console.warn("LEVELS",l);const c=l[l.length-1][0].find(e=>e.rootLHS===n),_=c?c.parseTrees(t):[];return console.warn("RESULT",_),_}matchLanguageToken_(e,t){return Object.keys(T2C.MSG).map(e=>e.toUpperCase()).some(n=>T2C.MSG[n]&&T2C.MSG[n]["TERMINAL_"+e.toUpperCase()]===t.value)}flattenOneLevel_(e){return e.reduce((e,t)=>e.concat(t),[])}joinEachItemToFront_(e,t){return this.flattenOneLevel_(t.map(t=>e.map(e=>[e].concat(t))))}getRHSOfTokenMatch_(e,t){return-1!==this.lexer_.isTokenType(e)&&t.tokenType===e||-1!==this.terminals_.indexOf(e)&&Array.from(this.ruleSets_[e]).some(e=>e===t.value||this.matchLanguageToken_(e,t))?t.value:null}isTerminal_(e){return-1!==this.terminals_.indexOf(e)||this.lexer_.isTokenType(e)}parseTopDown(e){console.log(this.ruleSets_);const t=Object.values(this.ruleSets_).reduce((e,t)=>e+t.size,0),n=this.lexer_.tokenize(e),s=new Memoizer,r=this.maxPathLengthToTerminalOrSplit_("statement");console.log("ARRAY:",r,r.length,t);const o=(e,t,i,a)=>{if(0===a||e instanceof Array&&0===e.length||e instanceof Array&&e.length>i-t+1)return[];if("string"==typeof e&&this.isTerminal_(e)){if(t!==i)return[];let s=this.getRHSOfTokenMatch_(e,n[t]);return s?[{lhs:e,rhs:[s]}]:[]}if("string"==typeof e)return this.flattenOneLevel_(Array.from(this.ruleSets_[e]).map(n=>{let r=s.compute(o,[n,t,i,a-1],0);return r.some(e=>e.length!==n.length)?(console.log("throwing out",e,JSON.stringify(r),n),console.log("problem",n,r,r.find(e=>e.length!==n.length)),null):r.map(t=>({lhs:e,rhs:t}))}).filter(e=>e));if(e instanceof Array&&1===e.length){let n=s.compute(o,[e[0],t,i,a]);return n.length>0?n.map(e=>[e]):[]}{let n=[];for(let a=t;a<i;a++){let l=s.compute(o,[e[0],t,a,r.length]);if(l.length>0){let t=s.compute(o,[e.slice(1),a+1,i,r.length]);t.length>0&&n.push(...this.joinEachItemToFront_(l,t))}}return n}};console.log("Token Array:",n);const i=s.compute(o,["statement",0,n.length-1,r.length]);return s.clear(),i}}},function(e,t,n){"use strict";class s{static interpolateMsg_(e,t,n={}){let s=e,r=0;for(;/{[^}]+}/.test(s)&&r<5;)s=s.replace(/{[^}]+}/g,e=>{const s=e.substring(1,e.length-1),r=s.split("."),o={T2C:T2C,options:n,feedbackItem:t}[r[0]];return o?r.slice(1).reduce((e,t)=>e[t],o):null!=n[s]?n[s]:t[s]}),r++;return s}static getFeedback(e,t,n){const r={block:Blockly.Block,field:Blockly.Field},o=e.map(e=>({msgArr:[]}));return t.forEach(t=>{let i=[];if("id"===t.selectType){const n=e.findIndex(e=>e.id===t.id);-1!==n&&i.push({index:n,item:e[n]})}else if("expected"===t.selectType)e.forEach((n,s)=>{(n.expected===t.expected||"function"==typeof t.expected&&t.expected(n.expected))&&i.push({index:s,item:e[s]})});else if(Object.keys(r).includes(t.selectType)){const n=r[t.selectType];e.forEach((t,s)=>{t.match instanceof n&&t.match.type&&i.push({index:s,item:e[s]})})}if("error"===t.showType?i=i.filter(e=>e.item.hasError):"correct"===t.showType&&(i=i.filter(e=>!e.item.hasError)),"string"===t.outputType)i.forEach(r=>o[r.index].msgArr.push(s.interpolateMsg_(t.msg,e[r.index],n)));else if("function"===t.outputType){const s=n[t.msg]||t.msg;"function"==typeof s&&i.forEach(t=>o[t.index].msgArr.push(s(e[t.index],e,n)))}}),o}static displayFeedback(e,t,n){const r=s.getFeedback(e,t,n),o=e.map(e=>e.match||e.remaining).map(e=>e instanceof Blockly.Block||!e?e:e.getSourceBlock&&e.getSourceBlock()),i=[],a=[];o.forEach((t,n)=>{if(t instanceof Blockly.Block){const s=i.indexOf(t);-1!==s?(a[s].indexArr.push(n),a[s].feedbackMsgArr.push(r[n].msgArr),a[s].hasCorrectItem=a[s].hasCorrectItem||!e[n].hasError,a[s].hasErrorItem=a[s].hasErrorItem||e[n].hasError,a[s].isMatchComplete=a[s].isMatchComplete&&e[n].isMatchComplete):(i.push(t),a.push({block:t,indexArr:[n],feedbackMsgArr:[r[n].msgArr],hasCorrectItem:!e[n].hasError,hasErrorItem:e[n].hasError,isMatchComplete:e[n].isMatchComplete}))}}),s.addFeedbackToBlocks(i,a.map(e=>e.feedbackMsgArr)),a.forEach(e=>{const t=e.block;e.hasErrorItem&&!e.hasCorrectItem?s.setBlockFeedbackColour(t,!1):!e.hasErrorItem&&e.hasCorrectItem?s.setBlockFeedbackColour(t,!0,e.isMatchComplete):s.restoreBlockFeedbackColour(t)})}static addFeedbackToBlocks(e,t){e.length>0&&e[0].workspace.getAllBlocks().forEach(t=>{e.includes(t)||(t.setCommentText(""),t.setCommentText(null),null!=t.startColour&&t.setColour(t.startColour))}),e.forEach((e,n)=>{const s=t[n].map(e=>e.join("\n")).join("\n\n");if(""!==s.trim()){e.setCommentText(s.trim());let{width:t,height:n}=e.getCommentIcon().getBubbleSize();n=Math.max(n,Math.ceil(30*s.trim().length*8/t)),e.getCommentIcon().setBubbleSize(t,n)}else e.setCommentText("")})}static restoreBlockFeedbackColour(e){null!=e.startColour&&e.setColour(e.startColour)}static setBlockFeedbackColour(e,t,n=!1){e instanceof Blockly.Block&&(e.getCommentText()&&e.getCommentText().trim()||n?(null==e.startColour&&(e.startColour=e.getColour()),t?e.setColour("#080"):e.setColour("#800")):s.restoreBlockFeedbackColour(e))}}t.a=s},,function(e,t){
/**
 * @license
 * Visual Blocks Editor
 *
 * Copyright 2012 Google Inc.
 * https://developers.google.com/blockly/
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Blockly.Blocks.math_arithmetic_basic={init:function(){this.jsonInit({message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[[Blockly.Msg.MATH_ADDITION_SYMBOL,"ADD"],[Blockly.Msg.MATH_SUBTRACTION_SYMBOL,"MINUS"],[Blockly.Msg.MATH_MULTIPLICATION_SYMBOL,"MULTIPLY"],[Blockly.Msg.MATH_DIVISION_SYMBOL,"DIVIDE"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",colour:Blockly.Msg.MATH_HUE,helpUrl:Blockly.Msg.MATH_ARITHMETIC_HELPURL});var e=this;this.setTooltip((function(){var t=e.getFieldValue("OP");return{ADD:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_ADD,MINUS:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS,MULTIPLY:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY,DIVIDE:Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE}[t]}))}},Blockly.Blocks.math_change=null},function(e,t){
/**
 * @license
 * Visual Blocks Editor
 *
 * Copyright 2012 Google Inc.
 * https://developers.google.com/blockly/
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Blockly.Blocks.text_print={init:function(){this.jsonInit({message0:T2C.MSG.currentLanguage.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_PRINT_TOOLTIP,helpUrl:Blockly.Msg.TEXT_PRINT_HELPURL})}},Blockly.Blocks.js_text_print={init:function(){this.jsonInit({message0:"console.log(%1);",args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_PRINT_TOOLTIP,helpUrl:Blockly.Msg.TEXT_PRINT_HELPURL})}},Blockly.Blocks.text_input={init:function(){this.jsonInit({message0:T2C.MSG.currentLanguage.TEXT_INPUT_TITLE,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_PROMPT_TOOLTIP_TEXT,helpUrl:Blockly.Msg.TEXT_PROMPT_HELPURL})}},Blockly.Blocks.js_text_input={init:function(){this.jsonInit({message0:"prompt(%1)",args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_PROMPT_TOOLTIP_TEXT,helpUrl:Blockly.Msg.TEXT_PROMPT_HELPURL})}},Blockly.Blocks.t2c_text_join={init:function(){this.jsonInit({message0:"%1 + %2",args0:[{type:"input_value",name:"A",check:"String"},{type:"input_value",name:"B",check:"String"}],inputsInline:!0,output:"String",colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_PLUS_TOOLTIP_TEXT,helpUrl:""})}},Blockly.Blocks.t2c_text_length={init:function(){this.jsonInit({message0:T2C.MSG.currentLanguage.TEXT_T2C_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:"String"}],inputsInline:!0,output:"Number",colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_T2C_LENGTH_TOOLTIP,helpUrl:""})}},Blockly.Blocks.t2c_text_indexof={init:function(){this.jsonInit({message0:T2C.MSG.currentLanguage.TEXT_T2C_INDEXOF_TITLE,args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"input_value",name:"FIND",check:"String"}],inputsInline:!0,output:"Number",colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_T2C_INDEXOF_TOOLTIP,helpUrl:""})}},Blockly.Blocks.js_text_indexof={init:function(){this.appendValueInput("VALUE").setCheck("String"),this.appendValueInput("FIND").setCheck("String").appendField(".indexOf("),this.appendDummyInput().appendField(")"),this.setInputsInline(!0),this.setOutput(!0,"Number"),this.setColour(Blockly.Msg.TEXTS_HUE),this.setTooltip(T2C.MSG.currentLanguage.TEXT_T2C_INDEXOF_TOOLTIP.replace("%1",0)),this.setHelpUrl(Blockly.Msg.TEXT_INDEXOF_HELPURL)}},Blockly.Blocks.t2c_text_charat={init:function(){this.jsonInit({message0:T2C.MSG.currentLanguage.TEXT_T2C_CHARAT_TITLE,args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"input_value",name:"AT",check:"Number"}],inputsInline:!0,output:"String",colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_CHARAT_FROM_START_TOOLTIP,helpUrl:Blockly.Msg.TEXT_CHARAT_HELPURL})}},Blockly.Blocks.t2c_text_getsubstring={init:function(){this.jsonInit({message0:T2C.MSG.currentLanguage.TEXT_T2C_GET_SUBSTRING_TITLE,args0:[{type:"input_value",name:"STRING",check:"String"},{type:"input_value",name:"AT1",check:"Number"},{type:"input_value",name:"AT2",check:"Number"}],inputsInline:!0,output:"String",colour:Blockly.Msg.TEXTS_HUE,tooltip:T2C.MSG.currentLanguage.TEXT_T2C_GET_SUBSTRING_TOOLTIP,helpUrl:Blockly.Msg.TEXT_GET_SUBSTRING_HELPURL})}},Blockly.Blocks.t2c_text_after={init:function(){this.appendValueInput("TEXT").setCheck("String"),this.appendValueInput("SUB").setCheck("String").appendField(".getAfterTEXT("),this.appendDummyInput().appendField(")"),this.setInputsInline(!0),this.setOutput(!0,"String"),this.setColour(Blockly.Msg.TEXTS_HUE),this.setTooltip("returns all text appearing after second text in the first text"),this.setHelpUrl("")}},Blockly.Blocks.t2c_text_before={init:function(){this.appendValueInput("TEXT").setCheck("String"),this.appendValueInput("SUB").setCheck("String").appendField(".getBeforeTEXT("),this.appendDummyInput().appendField(")"),this.setInputsInline(!0),this.setOutput(!0,"String"),this.setColour(Blockly.Msg.TEXTS_HUE),this.setTooltip("returns all text appearing before second text in the first text"),this.setHelpUrl("")}},Blockly.Blocks.js_text_charat={init:function(){this.appendValueInput("VALUE").setCheck("String"),this.appendValueInput("AT").setCheck("Number").appendField(".charAt("),this.appendDummyInput().appendField(")"),this.setInputsInline(!0),this.setOutput(!0,"String"),this.setColour(Blockly.Msg.TEXTS_HUE),this.setTooltip(T2C.MSG.currentLanguage.TEXT_CHARAT_FROM_START_TOOLTIP),this.setHelpUrl(Blockly.Msg.TEXT_CHARAT_HELPURL)}},Blockly.Blocks.js_text_getsubstring={init:function(){this.appendValueInput("STRING").setCheck("String"),this.appendValueInput("AT1").setCheck("Number").appendField(".substring("),this.appendValueInput("AT2").setCheck("Number").appendField(", "),this.appendDummyInput().appendField(")"),this.setInputsInline(!0),this.setOutput(!0,"String"),this.setColour(Blockly.Msg.TEXTS_HUE),this.setTooltip(T2C.MSG.currentLanguage.TEXT_T2C_GET_SUBSTRING_TOOLTIP),this.setHelpUrl(Blockly.Msg.TEXT_GET_SUBSTRING_HELPURL)}}},,,,,,,,function(e,t,n){"use strict";n.r(t),n(16),n(17);var s=n(1),r=n(3),o=n(14),i=n(0);!function(){function e(e,n,s,r){r=r||(e=>e);const o=n.slice(1).map(n=>t(n[0],e)).filter(e=>e).filter(r).map(e=>[e,e]);!function(e,t){for(;e.length>0;)e.pop();e.push(...t)}(s,[n[0]].concat(o))}function t(e,n){let s;if(e.length){if(n.length){if(s=e.match(/^%[a|s|d|v]/)){const r=t(e.substring(s[0].length),n.substring(1))||t(e,n.substring(1));return r&&n.charAt(0)+r}if(s=e.match(/^%o/)){const r=t(e.substring(s[0].length),n);if(r)return r;const o=t(e,n.substring(1));return o&&n.charAt(0)+o}if(n.charAt(0)===e.charAt(0)){const s=t(e.substring(1),n.substring(1));return s&&n.charAt(0)+s}return""}{const t=e.search(/%[a|s|d|v|o]/);return e.substring(0,-1!==t?t:e.length)}}return""}Blockly.Blocks.code_expression={init:function(){var e={editing:!1};this.appendDummyInput("STRING").appendField(new Blockly.FieldMultilineInput("",(function(t){t&&(e.editing=!0)})),"EXP"),this.setInputsInline(!0),this.setOutput(!0),this.setColour(60),this.setTooltip(T2C.MSG.currentLanguage.TYPEIN_EXPRESSION_TOOLTIP),this.onchange=s.parseAndConvertToBlocks.bind(this,e)}},Blockly.Blocks.code_statement={init:function(){const n=[["Autocomplete Options",""],T2C.MSG.currentLanguage.TEXT_PRINT_TITLE.replace("%1","%a"),Blockly.Msg.VARIABLES_SET.replace("%1","%v").replace("%2","%a"),T2C.MSG.currentLanguage.TEXT_INPUT_TITLE.replace("%1","%s"),T2C.MSG.currentLanguage.TEXT_T2C_LENGTH_TITLE.replace("%1","%s"),T2C.MSG.currentLanguage.TEXT_T2C_INDEXOF_TITLE.replace("%1","%s").replace("%2","%s"),T2C.MSG.currentLanguage.TEXT_T2C_CHARAT_TITLE.replace("%1","%s").replace("%2","%d"),T2C.MSG.currentLanguage.TEXT_T2C_GET_SUBSTRING_TITLE.replace("%1","%s").replace("%2","%d").replace("%3","%d")].map((e,t)=>0===t?e:1===t||2===t||/^%[a|s|d|v]/.test(e)?[e,e]:["%o"+e,e]);console.warn(n);const r=n.map((e,n)=>{if(0===n)return e;const s=t(e[0],"");return[s,s]}).filter(e=>e[0]);console.warn("SHOWN",r);const o={editing:!1,OPTIONS:n,shownOPTIONS:r,updateAutocomplete:e};console.warn("PROPS",o),this.appendDummyInput("FILLER").appendField(T2C.MSG.currentLanguage.TYPEIN_STATEMENT_TITLE).appendField(new Blockly.FieldDropdown(r),"AUTOCPLT"),this.appendDummyInput("STRING").appendField(new Blockly.FieldMultilineInput("",e=>{e&&(o.editing=!0)}),"EXP"),this.setInputsInline(!1),this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(60),this.setTooltip(T2C.MSG.currentLanguage.TYPEIN_STATEMENT_TOOLTIP),this.onchange=s.parseAndConvertToBlocks.bind(this,o)}},Blockly.Blocks.code_statement_hybrid={init:function(){this.jsonInit({message0:"%1 %2 %3",args0:[{type:"field_dropdown",name:"MODE",options:[["Text Mode","TEXT"],["Block Mode","BLOCK"]]},{type:"field_input",name:"EXP"},{type:"input_dummy",name:"INPUT_MODE"}],inputsInline:!0,tooltip:T2C.MSG.currentLanguage.TYPEIN_EXPRESSION_TOOLTIP,nextStatement:!0,previousStatement:!0,colour:60,mutator:"block_text_toggle",helpUrl:Blockly.Msg.MATH_ARITHMETIC_HELPURL}),this.onchange=Blockly.Constants.TypeIn.BLOCK_TEXT_TOGGLE_EXTENSION.bind(this),this.setInitialMaxInstances(),this.updateWorkspaceMaxBlocksOnModeChange(!0)},setMatchBlueprint:function(e){this.matchBlueprint=e},setTextMatch:function(e){this.textMatch=e},setTextFeedbackManager:function(e){this.feedbackManagerText=e},setBlockFeedbackManager:function(e){this.feedbackManagerBlock=e},setInitialMaxInstances:function(){if(console.assert(!this.initialMaxInstances,"Initial max instances for "+this.toString()+" already set."),this.initialMaxInstances={},this.workspace.options&&this.workspace.options.maxInstances){const e=this.workspace.options.maxInstances;Object.keys(e).forEach(t=>{this.initialMaxInstances[t]=e[t]})}console.warn("MY MAX INSTANCES",this.id,this.initialMaxInstances)},setCurrentMaxInstances:function(e){console.assert(this.initialMaxInstances,"Attempting to set current max instances for "+this.toString()+" before initializing its max instances.");const t={};return this.initialMaxInstances=this.initialMaxInstances||{},this.currentMaxInstances=this.currentMaxInstances||{},Object.keys(this.initialMaxInstances).forEach(e=>{t[e]=this.initialMaxInstances[e]}),e&&r.a.getMaxInstancesFromMatch(e,t),Object.keys(this.currentMaxInstances).forEach(e=>{t[e]||(t[e]=0)}),this.currentMaxInstances=t,this.updateMaxInstances&&(this.workspace&&(this.workspace.options||(this.workspace.options={}))&&(this.workspace.options.maxInstances=this.currentMaxInstances),this.toolboxManager&&Object.keys(this.currentMaxInstances).forEach(e=>{this.currentMaxInstances[e]&&(this.toolboxManager.findToolboxBlockWithType(e)||this.toolboxManager.createToolboxBlock(e,!1))})),this.currentMaxInstances},updateWorkspaceMaxBlocksOnModeChange:function(e){this.updateMaxInstances=e},setToolboxManager:function(e){this.toolboxManager=e},isMatchComplete:function(){return"#008800"===this.getColour()}},Blockly.Constants.TypeIn={},Blockly.Constants.TypeIn.BLOCK_TEXT_TOGGLE_MIXIN={mutationToDom:function(){const e=Blockly.utils.xml.createElement("mutation"),t="BLOCK"===this.getFieldValue("MODE");return e.setAttribute("is_block_mode",t),e},domToMutation:function(e){this.updateShape_(e.getAttribute("is_block_mode"))},updateShape_:function(e){if("true"===e||!0===e){let e;if(this.getField("EXP")&&this.matchBlueprint){const t=r.a.getMatchResult(this.getField("EXP"),{id:1e4,type:"field",name:"EXP",value:{type:"component",name:this.matchBlueprint.value.matchManagerType,value:this.matchBlueprint.value.value}}),n=r.a.getTextToParseFromMatch(t),o=[r.a.getTextToParseFromMatch(t,!0),n].map(e=>[e,e+")",e+"'",e+'"',e+"')",e+'")']).flat().find(e=>Object(s.getParseTree)(e)),a=Object(s.getParseTree)(o||"");e=a?Object(s.handleParseTreeToBlocks)(a,Object(i.e)(this.workspace,"text_print"),!1):"",this.matchBlueprint.value.value.textMode=!1;const l=r.a.getMatchResult(e,{id:-1,type:"component",name:this.matchBlueprint.value.matchManagerType,value:this.matchBlueprint.value.value});if(this.setCurrentMaxInstances(l),a){const t=r.a.getCorrectBlocksFromMatch(l);console.warn("Match and blocks",l,t),e.getDescendants().forEach(e=>{-1===t.indexOf(e)&&e.dispose(!0)}),this.workspace.render()}}this.getField("EXP")&&this.getInput("INPUT_MODE").removeField("EXP"),this.getInput("EXP_STATEMENT")||(this.appendStatementInput("EXP_STATEMENT"),e&&e.previousConnection?this.getInput("EXP_STATEMENT").connection.connect(e.previousConnection):e&&e.dispose())}else{let e="";if(this.setCurrentMaxInstances(),this.getInput("EXP_STATEMENT")){const t=this.getInputTargetBlock("EXP_STATEMENT");if(t&&(t.getDescendants().forEach(e=>{e.setCommentText(""),e.setCommentText(null)}),e=Blockly.JavaScript.blockToCode(t),t.dispose(),this.matchBlueprint)){this.matchBlueprint.value.value.textMode=!0;let t=e;do{const n=r.a.getMatchResult(e,{type:"component",name:this.matchBlueprint.value.matchManagerType,value:this.matchBlueprint.value.value});console.warn("Text Match",n,"S",e,"TRY S",t),t=r.a.getTextToParseFromMatch(n,!0)}while(t!==e&&""!==(e=e.substring(0,e.length-1)))}this.removeInput("EXP_STATEMENT")}this.getField("EXP")||this.getInput("INPUT_MODE").appendField(new Blockly.FieldTextInput(e,()=>{}),"EXP")}}},Blockly.Constants.TypeIn.BLOCK_TEXT_TOGGLE_EXTENSION=function(e){if(!this.workspace.isFlyout){if(("mutatorOpen"===e.element&&!e.newValue||"bubble_open"===e.type&&!e.isOpen)&&(this.setFieldValue("TEXT","MODE"),this.updateShape_(!1)),this.getField("MODE").setValidator((function(e){this.getSourceBlock().updateShape_("BLOCK"===e)})),"workspaceClick"===e.element||"workspace"===e.targetType)if(this.isMatchComplete()){this.setFieldValue("BLOCK","MODE"),this.updateShape_(!0);const e=this.getPreviousBlock(),t=this.getNextBlock(),n=this.getInputTargetBlock("EXP_STATEMENT");n&&(n.getDescendants().forEach(e=>{e.startColour&&e.setColour(e.startColour),e.setCommentText(null)}),n.unplug(),e&&n.previousConnection&&n.previousConnection.connect(e.nextConnection),t&&n.nextConnection&&n.nextConnection.connect(t.previousConnection)),this.dispose()}else if("TEXT"===this.getFieldValue("MODE")&&this.matchBlueprint&&this.getField("EXP")){let e=this.getFieldValue("EXP")||"",t=e;do{const n=r.a.getMatchResult(e,{type:"component",name:this.matchBlueprint.value.matchManagerType,value:this.matchBlueprint.value.value});console.warn("Text Match",n,"S",e,"TRY S",t),t=r.a.getTextToParseFromMatch(n,!0)}while(t!==e&&""!==(e=e.substring(0,e.length-1)));this.setFieldValue(e,"EXP")}if(this.matchBlueprint){const e=r.a.getMatchResult(this,this.matchBlueprint);"TEXT"===this.getFieldValue("MODE")&&this.feedbackManagerText?o.a.displayFeedback(e,T2C.FeedbackManagers.code_statement_hybrid.feedbackJsonBlock,this.feedbackManagerText):"BLOCK"===this.getFieldValue("MODE")&&this.feedbackManagerBlock&&o.a.displayFeedback(e,this.feedbackManagerBlock.feedbackManager,this.feedbackManagerBlock)}}},Blockly.Extensions.registerMutator("block_text_toggle",Blockly.Constants.TypeIn.BLOCK_TEXT_TOGGLE_MIXIN,null,["variables_set","text_print","text_input","text","math_number","t2c_text_join"])}()}]);